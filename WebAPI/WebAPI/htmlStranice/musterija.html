<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="proba.css">

    <script src="Scripts/jquery-1.10.2.js"></script>
    <script src="Scripts/jquery.validate.js"></script>

    <script type="text/javascript">

        function openPage(pageName, elmnt, color) {
            // Hide all elements with class="tabcontent" by default */
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            // Remove the background color of all tablinks/buttons
            tablinks = document.getElementsByClassName("tablink");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].style.backgroundColor = "";
            }

            // Show the specific tab content
            document.getElementById(pageName).style.display = "block";

            // Add the specific color to the button used to open the tab content
            elmnt.style.backgroundColor = color;
            
        }


    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            document.getElementById("tab2").click();
            $("#tab1").click(function () {
                $.get("/api/loggin", function (data, status) {
                    let ulogovaniKorisnik = JSON.parse(localStorage.getItem("ulogovan"));
                    $("#korisnickoIme").val(data.KorisnickoIme);
                    $("#korisnickoIme3").val(data.KorisnickoIme);
                    $("#ime").val(data.Ime);
                    $("#prezime").val(data.Prezime);
                    if (data.Pol == 0) {
                        $("#Muski").attr("selected", "true");
                    }
                    else {
                        $("#Zenski").attr("selected", "true");
                    } 
                    $("#kontaktTelefon").val(data.KontaktTelefon);
                    $("#lozinka").val(data.Lozinka);
                    $("#jmbg").val(data.Jmbg);
                    $("#email").val(data.Email);
                    $("#uloga").val(data.Uloga);
                    $("#voznje").val(data.VoznjeKorisnika);
                });
            });
            $("#Voznje").click(function () {
                $.get("/api/voznjeKorisnika", function (data, status) {
                    var i;
                    var o;
                    var iz;
                    var korisnik;
                    $("#tabela").empty();
                    var s1 = $("<th></th>").text("Lokacija");
                    var s2 = $("<th></th>").text("Vreme porucivalja");
                    var s3 = $("<th colspan=\"2\"></th>").text("Opcije");
                    for (i = 0; i < data.length; i++) {                        
                        var txt2 = $("<td></td>").text(data[i].Odrediste.Adresa);
                        var txt3 = $("<td></td>").text(data[i].Datum);
                        var txt4 = $("<input type=\"submit\" value=\"izmeni\">").attr("id", "izmeni_" + i);
                        var txt5 = $("<input type=\"submit\" value=\"obrisi\">").attr("id", "obrisi_" + i);
                        $("#tabela").append("<tr>",s1,s2,s3,"</tr>","<tr>", txt2, txt3, txt4, txt5, "</tr>");
                        korisnik = data[i].Musterija;
                        iz = "izmeni_" + i;
                        o = "obrisi_" + i;
                        $("#izmeni_" + i).click(function () {
                            $.ajax({
                                url: 'api/izmena/post',
                                method: 'POST',
                                data: {
                                    KorisnickoImeVozaca: iz,
                                    Lokacija2: korisnik
                                }
                            });
                            alert("udje ti");
                            document.getElementById("Voznje").click();
                        });
                        $("#obrisi_" + i).click(function () {
                            $.ajax({
                                url: 'api/izmena/post',
                                method: 'POST',
                                data: {
                                    KorisnickoImeVozaca: o,
                                    Lokacija2: korisnik
                                }
                            });
                            document.getElementById("Voznje").click();
                        });
                    }
                   
                });
            });
        });
    </script>
</head>
<body>
    <h1>MUSTERIJA</h1>
    <!-- Tab links -->

    <button class="tablink" id="tab1" onclick="openPage('My Profile', this)">My Profile</button>
    <button class="tablink" id="tab2" onclick="openPage('Zahtev za voznju', this)">Zahtev za voznju</button>
    <button class="tablink" id="Voznje" onclick="openPage('Voznje na cekanju', this)">Voznje na cekanju</button>


    <div id="My Profile" class="tabcontent">
        <h3>My Profile</h3>


        <form method="post" id="musterijaPromena">
            <p>
                <table>
                    <tr>
                        <th colspan="2" align="center">Vaši podaci</th>
                    </tr>
                    <tr>
                        <th>Korisnicko ime: </th>
                        <td><input type="text" readonly id="korisnickoIme" name="korisnickoIme"></td>
                    </tr>
                    <tr>
                        <th>Lozinka: </th>
                        <td><input type="text" id="lozinka" name="lozinka"></td>
                    </tr>
                    <tr>
                        <th>Ime: </th>
                        <td><input type="text" id="ime" name="ime"></td>
                    </tr>
                    <tr>
                        <th>Prezime: </th>
                        <td><input type="text" id="prezime" name="prezime"></td>
                    </tr>
                    <tr>

                        <th>Pol: </th>
                        <td>
                            <select id="pol" name="pol">
                                <option value="Muski" id="Muski">Muski</option>
                                <option value="Zenski" id="Zenski">Zenski</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <th>JMBG: </th>
                        <td><input type="text" id="jmbg" name="jmbg"></td>
                    </tr>
                    <tr>
                        <th>Kontakt telefon: </th>
                        <td><input type="text" id="kontaktTelefon" name="kontaktTelefon"></td>
                    </tr>
                    <tr>
                        <th>E-mail: </th>
                        <td><input type="text" id="email" name="email"></td>
                    </tr>
                    <tr>
                        <th>Voznje: </th>
                        <td><input type="text" id="voznje" name="voznje"></td>
                    </tr>
                    <tr>
                        <td colspan="2" align="center"><input type="submit" value="Sačuvaj"></td>
                    </tr>
                </table>
            </p>
        </form>
        <script>
            validatePromena();
        </script>

    </div>
    <div id="Zahtev za voznju" class="tabcontent">
        <form method="post" id="idZahtev">
            <table border="1">
                <tr>
                    <th>Unesite lokaciju:</th>
                    <td><input type="text" name="Lokacija.adresa"><input type="hidden" name="korisnickoIme3" id="korisnickoIme3"></td>
                </tr>
                <tr>
                    <th>Vozilo:</th>
                    <td>
                        <select id="tipAutomobila" name="Automobil.tipAutomobila">
                            <option value="Podrazumevani" id="Podrazumevani">Podrazumevani</option>
                            <option value="Putnicki" id="Putnicki">Putnicki</option>
                            <option value="Kombi" id="Kombi">Kombi</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" align="center"><input type="submit" value="Naruci"></td>
                </tr>
            </table>
        </form>
        <script>
            ZahtevValidate();
        </script>
    </div>


    <div id="Voznje na cekanju" class="tabcontent">
            <table border="1" id="tabela">
                
            </table>
    </div>
</body>
</html>